import{c as k,u as w,a as C,r as T,j as e,B as u,b as S}from"./index-12ba5e1e.js";import{C as M}from"./index-69f8b09f.js";import{e as x}from"./emergencyHospitals-0f7a254e.js";const h={latitude:35.701835,longitude:139.763417,name:"åŸºåœ°ç—…é™¢"},A=[{id:"scene-001",name:"æ±äº¬å¤§å­¦æœ¬éƒ·ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹",latitude:35.7122,longitude:139.7629,address:"æ±äº¬éƒ½æ–‡äº¬åŒºæœ¬éƒ·7-3-1",locationType:"public",landmarks:["å®‰ç”°è¬›å ‚","èµ¤é–€","æ­£é–€"],accessNotes:"æ­£é–€ã‹ã‚‰å…¥æ§‹å¯èƒ½"},{id:"scene-002",name:"ä¸Šé‡å…¬åœ’",latitude:35.7156,longitude:139.7745,address:"æ±äº¬éƒ½å°æ±åŒºä¸Šé‡å…¬åœ’",locationType:"public",landmarks:["ä¸Šé‡å‹•ç‰©åœ’","å›½ç«‹åšç‰©é¤¨","è¥¿éƒ·éš†ç››åƒ"],accessNotes:"è¤‡æ•°ã®å…¥å£ã‚ã‚Šã€å™´æ°´åºƒå ´ãŒç›®å°"},{id:"scene-003",name:"ç§‹è‘‰åŸé§…å‘¨è¾º",latitude:35.6984,longitude:139.7732,address:"æ±äº¬éƒ½åƒä»£ç”°åŒºå¤–ç¥ç”°1ä¸ç›®",locationType:"commercial",landmarks:["ç§‹è‘‰åŸé§…","ãƒ¨ãƒ‰ãƒã‚·ã‚«ãƒ¡ãƒ©","é›»æ°—è¡—"],accessNotes:"é§…å‰ãƒ­ãƒ¼ã‚¿ãƒªãƒ¼åˆ©ç”¨å¯èƒ½"},{id:"scene-004",name:"çš‡å±…æ±å¾¡è‹‘",latitude:35.6862,longitude:139.7571,address:"æ±äº¬éƒ½åƒä»£ç”°åŒºåƒä»£ç”°1-1",locationType:"public",landmarks:["å¤§æ‰‹é–€","ä¸‰ã®ä¸¸å°šè”µé¤¨","æœ¬ä¸¸è·¡"],accessNotes:"å¤§æ‰‹é–€ã‹ã‚‰å…¥å ´ã€è­¦å‚™å“¡ã«è¦é€£çµ¡"},{id:"scene-005",name:"éŠ€åº§ä¸­å¤®é€šã‚Š",latitude:35.6706,longitude:139.7641,address:"æ±äº¬éƒ½ä¸­å¤®åŒºéŠ€åº§4ä¸ç›®",locationType:"commercial",landmarks:["éŠ€åº§å››ä¸ç›®äº¤å·®ç‚¹","ä¸‰è¶Š","å’Œå…‰"],accessNotes:"æ­©è¡Œè€…å¤©å›½æ™‚é–“ã«æ³¨æ„"},{id:"scene-006",name:"æ±äº¬ã‚¹ã‚«ã‚¤ãƒ„ãƒªãƒ¼å‘¨è¾º",latitude:35.7101,longitude:139.8107,address:"æ±äº¬éƒ½å¢¨ç”°åŒºæŠ¼ä¸Š1ä¸ç›®",locationType:"commercial",landmarks:["æ±äº¬ã‚¹ã‚«ã‚¤ãƒ„ãƒªãƒ¼","ã‚½ãƒ©ãƒãƒ","æŠ¼ä¸Šé§…"],accessNotes:"è¦³å…‰ãƒã‚¹é§è»Šå ´åˆ©ç”¨å¯èƒ½"},{id:"scene-007",name:"æ—¥æœ¬æ©‹åœ°åŒº",latitude:35.6833,longitude:139.7731,address:"æ±äº¬éƒ½ä¸­å¤®åŒºæ—¥æœ¬æ©‹1ä¸ç›®",locationType:"commercial",landmarks:["æ—¥æœ¬æ©‹","ä¸‰è¶Šæœ¬åº—","ã‚³ãƒ¬ãƒ‰æ—¥æœ¬æ©‹"],accessNotes:"é¦–éƒ½é«˜ä¸‹ã€é“è·¯çŠ¶æ³ã«æ³¨æ„"},{id:"scene-008",name:"æµ…è‰å¯ºå¢ƒå†…",latitude:35.7148,longitude:139.7967,address:"æ±äº¬éƒ½å°æ±åŒºæµ…è‰2-3-1",locationType:"public",landmarks:["é›·é–€","äº”é‡å¡”","æœ¬å ‚"],accessNotes:"ä»²è¦‹ä¸–é€šã‚Šã¯è»Šä¸¡é€²å…¥ä¸å¯"},{id:"scene-009",name:"ç¥ç”°é§…å‘¨è¾º",latitude:35.6918,longitude:139.7708,address:"æ±äº¬éƒ½åƒä»£ç”°åŒºå†…ç¥ç”°3ä¸ç›®",locationType:"commercial",landmarks:["ç¥ç”°é§…","ç¥ç”°æ˜ç¥","ä¸‡ä¸–æ©‹"],accessNotes:"é§…å‰ã‚¿ã‚¯ã‚·ãƒ¼ä¹—ã‚Šå ´åˆ©ç”¨å¯èƒ½"},{id:"scene-010",name:"å¾Œæ¥½åœ’ãƒ»æ±äº¬ãƒ‰ãƒ¼ãƒ ",latitude:35.7056,longitude:139.7523,address:"æ±äº¬éƒ½æ–‡äº¬åŒºå¾Œæ¥½1ä¸ç›®",locationType:"public",landmarks:["æ±äº¬ãƒ‰ãƒ¼ãƒ ","å¾Œæ¥½åœ’éŠåœ’åœ°","ãƒ©ã‚¯ãƒ¼ã‚¢"],accessNotes:"ã‚¤ãƒ™ãƒ³ãƒˆé–‹å‚¬æ™‚ã¯äº¤é€šè¦åˆ¶ã‚ã‚Š"},{id:"scene-011",name:"æ–°å®¿åŒºå½¹æ‰€å‘¨è¾º",latitude:35.6938,longitude:139.7035,address:"æ±äº¬éƒ½æ–°å®¿åŒºæ­Œèˆä¼ç”º1ä¸ç›®",locationType:"public",landmarks:["æ–°å®¿åŒºå½¹æ‰€","æ–°å®¿ä¸­å¤®å…¬åœ’","éƒ½åº"],accessNotes:"åŒºå½¹æ‰€é§è»Šå ´åˆ©ç”¨å¯èƒ½"},{id:"scene-012",name:"ç¯‰åœ°å ´å¤–å¸‚å ´",latitude:35.6654,longitude:139.7707,address:"æ±äº¬éƒ½ä¸­å¤®åŒºç¯‰åœ°4ä¸ç›®",locationType:"commercial",landmarks:["ç¯‰åœ°æœ¬é¡˜å¯º","å ´å¤–å¸‚å ´","ç¯‰åœ°å·å…¬åœ’"],accessNotes:"æ—©æœã¯å¸‚å ´é–¢ä¿‚è»Šä¸¡ã«æ³¨æ„"},{id:"scene-013",name:"éŒ¦ç³¸ç”ºé§…å‰",latitude:35.6967,longitude:139.8147,address:"æ±äº¬éƒ½å¢¨ç”°åŒºæ±Ÿæ±æ©‹3ä¸ç›®",locationType:"transport",landmarks:["éŒ¦ç³¸ç”ºé§…","ã‚¢ãƒ«ã‚«ã‚­ãƒƒãƒˆ","ã‚ªãƒªãƒŠã‚¹"],accessNotes:"å—å£ãƒ­ãƒ¼ã‚¿ãƒªãƒ¼åˆ©ç”¨æ¨å¥¨"},{id:"scene-014",name:"å“å·åŒºå½¹æ‰€å‘¨è¾º",latitude:35.6092,longitude:139.7301,address:"æ±äº¬éƒ½å“å·åŒºåºƒç”º2ä¸ç›®",locationType:"public",landmarks:["å“å·åŒºå½¹æ‰€","ã—ãªãŒã‚ä¸­å¤®å…¬åœ’"],accessNotes:"åŒºå½¹æ‰€æ­£é¢é§è»Šå ´åˆ©ç”¨å¯èƒ½"},{id:"scene-015",name:"äº€æˆ¸å¤©ç¥ç¤¾",latitude:35.697,longitude:139.8256,address:"æ±äº¬éƒ½æ±Ÿæ±åŒºäº€æˆ¸3-6-1",locationType:"public",landmarks:["äº€æˆ¸å¤©ç¥ç¤¾","ã‚¹ã‚«ã‚¤ãƒ„ãƒªãƒ¼å±•æœ›","è—¤ã®èŠ±"],accessNotes:"å‚æ‹è€…é§è»Šå ´ã‚ã‚Šï¼ˆç¥­äº‹æ™‚é™¤ãï¼‰"}],D=(c,i)=>{const n=(c-h.latitude)*Math.PI/180,a=(i-h.longitude)*Math.PI/180,o=Math.sin(n/2)*Math.sin(n/2)+Math.cos(h.latitude*Math.PI/180)*Math.cos(c*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);return 6371*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))},P=(c=6)=>A.map(i=>({...i,distance:D(i.latitude,i.longitude)})).filter(i=>i.distance<=c).sort((i,m)=>i.distance-m.distance),B=()=>{const c=k(),{createCase:i,loading:m}=w(),{userInfo:n}=C(),[a,o]=T.useState({caseName:"",patientAge:"",patientGender:"male",patientName:"",sceneLatitude:"",sceneLongitude:"",hospitalLatitude:"",hospitalLongitude:"",description:""}),l=(s,t)=>{o({...a,[s]:t})},b=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(s=>{o({...a,sceneLatitude:s.coords.latitude.toString(),sceneLongitude:s.coords.longitude.toString()})},s=>{console.error("ä½ç½®æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ:",s),alert("ä½ç½®æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ‰‹å‹•ã§åº§æ¨™ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚")}):alert("ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯ä½ç½®æƒ…å ±ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚")},y=s=>{o({...a,sceneLatitude:s.latitude.toString(),sceneLongitude:s.longitude.toString()})},N=s=>{const t=x.find(r=>r.id===s);t&&o({...a,hospitalLatitude:t.latitude.toString(),hospitalLongitude:t.longitude.toString()})},g=P(6),f=async s=>{if(s.preventDefault(),!a.caseName.trim()){alert("äº‹æ¡ˆåã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");return}if(!a.sceneLatitude||!a.sceneLongitude){alert("ç¾å ´ã®ä½ç½®æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");return}if(!a.hospitalLatitude||!a.hospitalLongitude){alert("æ¬é€å…ˆç—…é™¢ã®ä½ç½®æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");return}try{const t=(d,p)=>({latitude:d,longitude:p,isEqual:j=>j.latitude===d&&j.longitude===p,toJSON:()=>({latitude:d,longitude:p})}),r=d=>({toDate:()=>d,toMillis:()=>d.getTime(),seconds:Math.floor(d.getTime()/1e3),nanoseconds:d.getTime()%1e3*1e6}),v={caseName:a.caseName.trim(),status:M.DISPATCHED,teamId:(n==null?void 0:n.uid)||"demo-user",patientInfo:{age:a.patientAge?parseInt(a.patientAge):void 0,gender:a.patientGender,name:a.patientName.trim()||void 0},sceneLocation:t(parseFloat(a.sceneLatitude),parseFloat(a.sceneLongitude)),hospitalLocation:t(parseFloat(a.hospitalLatitude),parseFloat(a.hospitalLongitude)),createdAt:r(new Date),updatedAt:r(new Date)},L=await i(v);alert("æ–°è¦äº‹æ¡ˆã‚’ä½œæˆã—ã¾ã—ãŸ"),c(`/cases/${L}`)}catch(t){console.error("äº‹æ¡ˆä½œæˆã‚¨ãƒ©ãƒ¼:",t),alert("äº‹æ¡ˆã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ")}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>c("/cases"),className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"æ–°è¦äº‹æ¡ˆä½œæˆ"})]}),e.jsx("div",{className:"text-sm text-gray-700",children:e.jsx("span",{className:"font-medium",children:n==null?void 0:n.name})})]})})}),e.jsx("main",{className:"max-w-4xl mx-auto py-6 sm:px-6 lg:px-8",children:e.jsx("div",{className:"px-4 py-6 sm:px-0",children:e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"åŸºæœ¬æƒ…å ±"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["äº‹æ¡ˆå ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.caseName,onChange:s=>l("caseName",s.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-primary",placeholder:"ä¾‹: 2024-06-14 æ¸‹è°·é§…å‰ äº¤é€šå¤–å‚·"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"æ‹…å½“ãƒãƒ¼ãƒ "}),e.jsx("input",{type:"text",value:(n==null?void 0:n.team)||"",className:"w-full px-3 py-2 border rounded-lg bg-gray-50",disabled:!0})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"æ‚£è€…æƒ…å ±"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"æ‚£è€…æ°å"}),e.jsx("input",{type:"text",value:a.patientName,onChange:s=>l("patientName",s.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-primary",placeholder:"æ°åï¼ˆä»»æ„ï¼‰"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"å¹´é½¢"}),e.jsx("input",{type:"number",value:a.patientAge,onChange:s=>l("patientAge",s.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-primary",placeholder:"å¹´é½¢",min:"0",max:"150"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"æ€§åˆ¥"}),e.jsxs("select",{value:a.patientGender,onChange:s=>l("patientGender",s.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-primary",children:[e.jsx("option",{value:"male",children:"ç”·æ€§"}),e.jsx("option",{value:"female",children:"å¥³æ€§"}),e.jsx("option",{value:"other",children:"ãã®ä»–"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["ç¾å ´ä½ç½®",e.jsx("span",{className:"text-sm text-gray-500 ml-2",children:"(åŸºåœ°ç—…é™¢ã‹ã‚‰6kmä»¥å†…)"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"äº‹æ¡ˆç™ºç”Ÿå ´æ‰€ã‚’é¸æŠ"}),e.jsxs("select",{value:"",onChange:s=>{const t=g.find(r=>r.id===s.target.value);t&&y(t)},className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-primary mb-2",children:[e.jsx("option",{value:"",children:"-- å ´æ‰€ã‚’é¸æŠã—ã¦ãã ã•ã„ --"}),g.map(s=>{var t;return e.jsxs("option",{value:s.id,children:[s.name," (",(t=s.distance)==null?void 0:t.toFixed(1),"km) - ",s.address]},s.id)})]})]}),e.jsxs("div",{className:"flex space-x-2 flex-wrap gap-2",children:[e.jsx(u,{type:"button",variant:"outline",size:"sm",onClick:b,children:"ğŸ“ ç¾åœ¨åœ°ã‚’å–å¾—"}),g.slice(0,4).map(s=>e.jsx(u,{type:"button",variant:"outline",size:"sm",onClick:()=>y(s),className:"text-xs",children:s.name},s.id))]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["ç·¯åº¦ ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",step:"any",value:a.sceneLatitude,onChange:s=>l("sceneLatitude",s.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-primary",placeholder:"35.658584"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["çµŒåº¦ ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",step:"any",value:a.sceneLongitude,onChange:s=>l("sceneLongitude",s.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-primary",placeholder:"139.701442"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"æ¬é€å…ˆç—…é™¢"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"æ•‘æ€¥å¯¾å¿œç—…é™¢ã‚’é¸æŠ"}),e.jsxs("select",{value:"",onChange:s=>{s.target.value&&N(s.target.value)},className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-primary mb-2",children:[e.jsx("option",{value:"",children:"-- ç—…é™¢ã‚’é¸æŠã—ã¦ãã ã•ã„ --"}),x.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.emergencyLevel==="tertiary"?"ä¸‰æ¬¡æ•‘æ€¥":s.emergencyLevel==="secondary"?"äºŒæ¬¡æ•‘æ€¥":"ä¸€æ¬¡æ•‘æ€¥",") - ",s.address]},s.id))]})]}),e.jsx("div",{className:"flex space-x-2 flex-wrap gap-2",children:x.slice(0,3).map(s=>e.jsx(u,{type:"button",variant:"outline",size:"sm",onClick:()=>N(s.id),className:"text-xs",children:s.name},s.id))}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["ç·¯åº¦ ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",step:"any",value:a.hospitalLatitude,onChange:s=>l("hospitalLatitude",s.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-primary",placeholder:"35.665498"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["çµŒåº¦ ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",step:"any",value:a.hospitalLongitude,onChange:s=>l("hospitalLongitude",s.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-primary",placeholder:"139.686567"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>c("/cases"),children:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«"}),e.jsxs(u,{type:"submit",disabled:m,className:"flex items-center",children:[m&&e.jsx(S,{size:"sm",className:"mr-2"}),"äº‹æ¡ˆã‚’ä½œæˆ"]})]})]})})})]})};export{B as CreateCasePage};
//# sourceMappingURL=CreateCasePage-8feb4f2e.js.map
